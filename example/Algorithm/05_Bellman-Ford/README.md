# 벨만-포드

다익스트라처럼, 한 노드에서 다른 노드까지의 최단거리를 구하는 알고리즘

## 특징

- 가중치가 음수일때도 사용이 가능하다 : 그러나 사이클을 이루고 있는 경우는 작동하지 않는다. 최단경로는 순환을 포함해서는 안되므로 경로의 길이는 최대 `|V|-1`이어야 하는데 만약에 싸이클을 계속 돌았을 경우 간선 합은 낮아지지만 정점은 이미 많이 방문한 상태임. 가중치는 낮더라도 실질적인 최단경로라고 볼 수가 없음
- 음수 사이클 존재 여부를 알 수 있다 : 그래프 정점의 개수를 V라고 할때 인접 간선을 검사하고 거리 값을 갱신하는 과정을 v-1번으로 제한하면, 시작 정점에서 특정 정점까지 도달하기 위해 거쳐가는 최대 간선 수는 v-1개이기 때문에 v번째 간선이 추가되면 사이클이 됨
- 최단경로는 분해가 가능해서, 시작 노드 s에서 v에 이르는 최단경로는 s에서 u까지의 최단경로에 이어서 u에서 v까지의 가중치를 더한 값이다.
  - 특정 노드에 대한 최단경로는 다른 노드로 향한 최단 경로도 포함한다
  - s부터 u까지의 최단 경로는 중간 어딘가 지점인 v까지의 경로 중 가장 가중치가 작은 경로에 v부터 u까지의 가중치를 더한 것이다
- relaxation : 가중치 갱신
  ```py
  if dist[v] > dist[u] + w(u,v):
    dist[v] = dist[u] + w(u,v)
  ```
  - s, u 사이의 최단경로를 구할 때 그래프 내 모든 엣지에 대해 relaxation을 수행한다. s, u 사이의 최단경로는 s와 u뿐일수도 있고, u를 제외한 그래프의 모든 노드 `|V|-1`개가 s, u 사이의 최단경로를 구성할 수도 있다. 벨만 포드 알고리즘은 모든 엣지에 대한 relax를 |V|-1회 수행함
  - 한번의 라운드를 거칠때마다 소스노드에 가까운 엣지들에 대하여 정확하게 최단경로가 기록됨 그리고 나중에 v-1번 했을때 최단 경로가 나옴
- v-1번의 횟수동안 그래프에 있는 모든 정점을 순회하며 relax를 한다. => 그래서 느리다
  - 릴렉스를 해야 하는 순서를 모르니까 모든 엣지에 대해 릴렉스를 한다
  - s에서 v까지 가는 경우에서 v를 뺀 모든 경로가 각각 최단거리일 수 있다(최악의 경우 v-1번을 다돌아야만 정확한 답이 나오는 것)
  - 다익스트라와의 차이점으로는 매 반복마다 모든 간선을 확인한다는 것임. 다익스트라는 방문하지 않은 노드 중 최단거리가 가장 가까운 노드만을 방문

## 로직흐름

1. 시작 정점을 결정한다
2. 시작 정점에서 각각 다른 정점까지의 값을 무한대로 초기화한다.
3. 현재 정점에서 모든 인접 정점들을 탐색하여, 기존에 저장되어 있는 인접 정점까지의 거리보다 현재 정점을 거쳐 인접 정점에 도달하는 거리가 더 짧을 경우 짧은 거리로 갱신해준다
4. 3번을 정점수-1만큼 반복한다
5. 위 과정을 모두 마치고 난 후 거리가 갱신되는 경우가 생긴다면 그래프에 음수 사이클이 존재한다는 것이다.

## 시간 복잡도

- 그래프의 모든 엣지에 대해 시작노드를 제외한 전체 노드수만큼 반복 수행하고, 마지막으로 그래프 모든 엣지에 대한 relax를 1번 수행해주므로 O(VE)임
  - 다익스트라가 O(ElogE)
- 엣지 수가 노드 수의 제곱까지 될 수 있으므로 최악의 경우 O(V^3)이 된다.
- 다익스트라보다 느리지만 음수 간선을 분석할 수 있다
