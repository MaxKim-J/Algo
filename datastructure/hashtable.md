# 해시 테이블
2020.01.22
관련 문제가 있을라나

## 정의
- 해시함수 : 데이터의 효율적 관리를 목적으로 임의의 길이의 데이터를 고정된 길이의 데이터로 매핑하는 함수. 매핑 전 원래 데이터의 값을 키, 후 데이터의 값을 해시값, 매핑하는 과정 자체가 해싱
- 해시 충돌 : 해시함수는 해시값의 개수보다 많은 키값을 해시값으로 변환(many-to-one)하기 때문에 서로 다른 두 개의 키에 대해 동일한 해시값을 내는 해시충돌(collision)이 발생한다. 
- 해시 테이블 : 해시함수를 사용하여 키를 해시값을 매핑하고 이 해시값을 색인, 주소 삼아 데이터의 값을 키와 함께 저장하는 자료구조를 해시테이블이라고 함. 이때 데이터가 저장되는 곳은 버킷, 혹은 슬롯이라고 함. 

### 왜 쓰나?
- 해시 충돌이 발생할 가능성이 있음에도 해시테이블을 쓰는 이유는 적은 리소스로 많은 데이터를 효과적으로 관리하기 위함.
- 하드디스크나 클라우드에 존재하는 **무한에 가까운 데이터들**을 **유한한 개수의 해시값**으로 매핑함으로써 작은 크기의 캐시 메모리로도 프로세스를 관리할 수 있음
- 색인에 해시값을 사용함으로써 모든 데이터를 살피지 않아도 **검색과 삽입, 삭제를 빠르게 수행할 수 있음**
- 해시함수는 언제나 동일한 해시값을 리턴하고, 해당 색인만 알면 해시테이블의 크기에 상관없이 데이터애 대단히 빠르게 접근할 수 있으며 색인은 단순계산(O(1))이라서 효율적, 데이터 엑세스의 시간복잡도가 O(1)
- 보안 분야에도 널리 사용. 키와 해시값 사이에 직접적인 연관이 없기 때문에 해시값만 가지고 키를 온전히 복원하기 어려움. 길이가 서로 다른 입력데이터에 대해 일정한 길이의 출력을 만들 수 있어 데이터 축약 기능도 수행

### 비교
- 이진탐색트리는 그래도 탐색시 O(log n)시간 소요
- 그냥 배열의 경우 데이터 탐색에는 상수시간 걸리지만, 메모리를 미리 할당해 둬야함

## 해시함수
### 종류
- 완전해시함수 : 충돌없이 원투원으로 매핑하는 해시 함수 => 비효율적
- c-universal : 충돌 확률이 해쉬테이블의 사이즈분의 c가 되는 해시함수. 골고루 매핑하고 완전해시 함수보다 계산하기 쉬움
### 좋은 해시 함수란
1. 충돌이 적어야 함
2. 빠르게 계산이 가능해야함

## 충돌 해결 방법
### open addressing
아래쪽으로 슬롯을 탐색하면서 가장 먼저 발견된 빈 슬롯에 저장한다  
이미 해싱된 값에 대해 슬롯이 채워져서 충돌이 발생한 경우 아래쪽으로 계속 탐색해서 먼저 발견된 빈 슬롯에 저장하는 방법으로 충돌을 해결함  
삽입이야 계속 들어가면 되지만 삭제연산이 복잡한편 : 그동안 충돌이 발생했을 때 계속 아래로 내려갔던 값들을 검사하여 위로 올려야함
```python
# open addressing에서의 삭제연산 

def remove(self, key):
  i = self.find_slot(key)

  if self.keys[i] == None:
    return None
  j = i

  self.keys[i] = None

  while True:
    j = (j+1) % self.size
    # 빈칸 만났을 때 -> 비로소 끝남
    if self.keys[j] == None:
      return i
      break

    k = self.hash_function(self.keys[j])

    # 다른 인덱스 키값을 가진 친구일때
    # 다 돌아봐서 빈칸으로 올릴 것을 search해줌
    # 조건에 안맞는게 나오고 나서, 이동 발생 안하고,나중에 j를 증가시켰을때 빈칸을 만나면 그때 끗
    if not (i<k<=j or j<i<k or k<=j<i):
      self.keys[i] = self.keys[j]
      self.keys[j] = None
      i = j
```

### chaining
slot에 몇개의 값만 저장하도록 하는게 아니라, 각 슬롯마다 연결리스트를 가지도록 하여 이론적으로 무한이 많은 값들을 저장하도록 하는 방법 : 이론적으로 보면 충돌이 그냥 계속 발생하지 않는 것. 충돌을 씹어버림

## reference
- [ratsgo`s blog - 해싱, 해시함수, 해시테이블](https://ratsgo.github.io/data%20structure&algorithm/2017/10/25/hash/)
- [신찬수 - 자료구조 강의 자료](https://hufs.goorm.io/learn/lecture/15634/%EC%9C%B5%EB%B3%B5%ED%95%A9sw-%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0-2019-%EC%8B%A0%EC%B0%AC%EC%88%98)